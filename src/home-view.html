
<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/iron-ajax/iron-request.html">
<link rel="import" href="../bower_components/iron-iconset-svg/iron-iconset-svg.html">
<link rel="import" href="../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../bower_components/paper-spinner/paper-spinner.html">
<link rel="import" href="../bower_components/paper-spinner/paper-spinner-behavior.html">
<link rel="import" href="../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="shared-styles.html">

<dom-module id="home-view">
  <template>
    <style include="shared-styles">
      :host {
        display: block;
        padding: 10px;
      }

      .masonry {
        column-count: 2; 
        column-gap: 1em;
      }

      .item {
        transition-timing-function: ease-out;
        transition-duration: .75s;
        background: #eee;
        padding: 10 10 10 10;
        display: inline-block;
        margin: 0 0 1em;
        width: 100%;
        text-align: center;
      }

      .item:hover {
        opacity: .55;
      }

      item:hover {
        opacity: .75;
      }

      .wrapper {
        width: 95%;
        margin: 3em auto;
      }

      .masonry {
        margin: 1.5em 0;
        padding: 0;
        -moz-column-gap: 1.5em;
        -webkit-column-gap: 1.5em;
        column-gap: 1.5em;
        font-size: .85em;
      }

      .item {
        display: inline-block;
        background: #fff;
        padding: 1em;
        margin: 0 0 1.5em;
        width: 100%;
        box-sizing: border-box;
        -moz-box-sizing: border-box;
        -webkit-box-sizing: border-box;
        box-shadow: 2px 2px 4px 0 #ccc;
        border-bottom: 1px solid #eee;
      }

      @media only screen and (min-width: 400px) {
        .masonry {
          -moz-column-count: 1;
          -webkit-column-count: 1;
          column-count: 1;
        }
      }

      @media only screen and (min-width: 700px) {
        .masonry {
          -moz-column-count: 3;
          -webkit-column-count: 3;
          column-count: 3;
        }
      }

      @media only screen and (min-width: 900px) {
        .masonry {
          -moz-column-count: 3;
          -webkit-column-count: 3;
          column-count: 3;
        }
      }

      @media only screen and (min-width: 1100px) {
        .masonry {
          -moz-column-count: 3;
          -webkit-column-count: 3;
          column-count: 3;
        }
      }

      @media only screen and (min-width: 1280px) {
        .wrapper {
          width: 1260px;
        }
      }

      .image {
        position: relative; 
      }

      h2 { 
        position: absolute; 
        top: 200px; 
        left: 0; 
        width: 100%; 
      }
      h2 span { 
        color: white; 
        font: bold 24px/45px Helvetica, Sans-Serif; 
        letter-spacing: -1px;  
        background: rgb(0, 0, 0); /* fallback color */
        background: rgba(0, 0, 0, 0.7);
        padding: 10px; 
      }

      paper-fab {
        --paper-fab-background: var(--app-secondary-color);
        bottom: 2.5%;
        right: 2.5%;
        position: fixed;
      }

    </style>

    <paper-spinner id="spinner" active="[[loading]]" active></paper-spinner>

    <div class="masonry">
      <!--<iron-image style="width:100%; height:500px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/business-image-polyn.png" class="item" on-click="_onClickBusiness" ></iron-image>
      <iron-image style="width:100%; height:300px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/spinster_records.jpg" class="item" on-click="_onClickBusiness" ></iron-image>
      <iron-image style="width:100%; height:375px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/halfprice.jpg" class="item" on-click="_onClickBusiness" ></iron-image>
      <iron-image style="width:100%; height:250px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/groovenet.jpg" class="item" on-click="_onClickBusiness" ></iron-image>
      <iron-image style="width:100%; height:300px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/vinyl_record_blue.jpg" class="item" on-click="_onClickBusiness" ></iron-image>
      <iron-image style="width:100%; height:400px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/off_the_record.jpg" class="item" on-click="_onClickBusiness" ></iron-image>
      <iron-image style="width:100%; height:275px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/vinyl_record_led_zepplin.jpg" class="item" on-click="_onClickBusiness" ></iron-image>
      <iron-image style="width:100%; height:200px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/recycled_books.jpg" class="item" on-click="_onClickBusiness" ></iron-image>
      <iron-image style="width:100%; height:450px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/vinyl_record_red.jpg" class="item" on-click="_onClickBusiness" ></iron-image>
      <iron-image style="width:100%; height:300px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/josey_records.jpg" class="item" on-click="_onClickBusiness" ></iron-image>
      <iron-image style="width:100%; height:200px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/andrew.jpg" class="item" on-click="_onClickBusiness" ></iron-image>-->
   
      <iron-image style="width:100%; height:500px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/Good-Records.png" class="item" on-tap="_onTapBusiness" ></iron-image>
      <iron-image style="width:100%; height:500px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/Bills-Records.png" class="item" on-tap="_onTapBusiness" ></iron-image>
      <iron-image style="width:100%; height:500px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/business-image-polyn.png" class="item" on-tap="_onTapBusiness" ></iron-image>
      <iron-image style="width:100%; height:500px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/Bills-Records.png" class="item" on-tap="_onTapBusiness" ></iron-image>
      <iron-image style="width:100%; height:500px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/business-image-polyn.png" class="item" on-tap="_onTapBusiness" ></iron-image>
      <iron-image style="width:100%; height:500px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/business-image-polyn.png" class="item" on-tap="_onTapBusiness" ></iron-image>
      <iron-image style="width:100%; height:500px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/Spinster-Records.png" class="item" on-tap="_onTapBusiness" ></iron-image>
      <iron-image style="width:100%; height:500px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/Spinster-Records.png" class="item" on-tap="_onTapBusiness" ></iron-image>
      <iron-image style="width:100%; height:500px; background-color: lightgray;" sizing="cover" class="item" preload fade src="images/test-images/business-image-polyn.png" class="item" on-tap="_onTapBusiness" ></iron-image>
      <paper-fab id="fab" icon="message" on-tap="_onTapCreateMessage"></paper-fab>


      <!--<img src ="images/test-images/good_records.jpg" class="item" on-click="_onClickBusiness">
      <img src="images/test-images/spinster_records.jpg" class="item" on-click="_onClickBusiness">
      <div class="item" on-click="_onClickItem"><b>Pink Floyd</b> - The Wall in sweet, premo condition! $150</div>
      <img src="images/test-images/halfprice.jpg" class="item" on-click="_onClickBusiness">
      <img src="images/test-images/groovenet.jpg" class="item" on-click="_onClickBusiness">
      <div class="item" on-click="_onClickItem"><b>How long...</b> Will it take Kevin to notice my changes?</div>
      <img src="images/test-images/vinyl_record_blue.jpg" class="item"on-click="_onClickItem">
      <img src="images/test-images/off_the_record.jpg" class="item" on-click="_onClickBusiness">
      <img src="images/test-images/vinyl_record_led_zepplin.jpg" class="item" on-click="_onClickItem">
      <img src="images/test-images/recycled_books.jpg" class="item" on-click="_onClickBusiness">
      <div class="item" on-click="_onClickItem"><b>Kevin</b> is a slacker! Probably becuase he's afraid of Javascript.</div>
      <img src ="images/test-images/vinyl_record_red.jpg" class="item"on-click="_onClickItem">
      <img src="images/test-images/josey_records.jpg" class="item" on-click="_onClickBusiness">
      <img src="images/test-images/andrew.jpg" class="item" on-click="_onClickItem">-->
    </div>

    <iron-ajax
      id="sendRequet"
      url="https://us-central1-polyn-3c431.cloudfunctions.net/sendRequest"
      method="POST"
      loading="{{loading}}"
      on-response="_handleSendRequestResponse"
      on-error="_handleSendRequestError"
      debounce-duration="300">
    </iron-ajax>

    <paper-dialog id="requestDialog">
      <p>What is your request?</p>
      <paper-input label="Short Description..." value="{{titleDialogValue}}"></paper-input>
      <paper-input label="Long Description..." value="{{bodyDialogValue}}"></paper-input>
      <div class="buttons">
        <paper-button dialog-dismiss>Cancel</paper-button>
        <paper-button on-tap="_onTapRequestDialogBtn" dialog-confirm autofocus>Request</paper-button>
      </div>
    </paper-dialog>

  </template>

  <script>
    class HomeView extends Polymer.GestureEventListeners(Polymer.Element) {
      static get is() { return 'home-view'; }

      static get properties() {
        return {
          loading: {
            type: Boolean,
            notify: true,
            value: false
          },
          titleDialogValue: {
            type: String,
            value: ""
          },
          bodyDialogValue: {
            type: String,
            value: ""
          }
        };
      }

      _onTapBusiness() {
        var polynApp = document.getElementById("polynApp");
        var businessView = polynApp.pushPageOnCurrentTab("business-view");
        businessView.businessId = 1;
      }
      
      _onClickItem() {
        var polynApp = document.getElementById("polynApp");
        var itemView = polynApp.pushPageOnCurrentTab("item-view");
        itemView.itemId = 2;
      }

      _onTapCreateMessage() {
        console.log("HomeView._onTapCreateMessage");

        this.$.requestDialog.toggle();
      }

      _onTapRequestDialogBtn() {
        console.log("HomeView._onTapRequestDialogBtn: " + this.titleDialogValue);

        var params = {
          categoryPath: "collectables/sub/vinylRecords" ,
          title: this.titleDialogValue,
          body: this.bodyDialogValue,
        };

        this.$.sendRequet.params = params;
        this.$.sendRequet.generateRequest();
      }

      _handleSendRequestResponse(data) {
        console.log("HomeView._handleSendRequestResponse");
        console.log("  status = " + data.detail.status);
      }

      _handleSendRequestError(e) {
        console.log("HomeView._handleSendRequestError");
        console.log("  status = ", e.status, e.statusText);
      }
    }

    window.customElements.define(HomeView.is, HomeView);
  </script>
</dom-module>
